import time

from esp8266tinylora.encryption import AES

frame_counter = 0

# TTN Device Address, 4 Bytes, MSB
devaddr = bytearray([0x04, 0x03, 0x02, 0x01])

# TTN Network Key, 16 Bytes, MSB
nwkey = bytearray([0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA])

# TTN Application Key, 16 Bytess, MSB
app = bytearray([0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB, 0xBB])

data_to_encrypt = bytearray([0x01, 0x02, 0x03])

aes = AES(devaddr, app, nwkey, frame_counter)

enc_data = aes.encrypt(data_to_encrypt)

# Should return bytearray(b'w1\x85')
print(enc_data)
